<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Email Auto Responder</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      width: 400px;
      min-height: 500px;
    }
    #root {
      height: 100%;
    }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <!-- React Development Build (replace with production build) -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  
  <!-- Babel for JSX transformation (remove in production) -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  
  <!-- Your React component -->
  <script type="text/babel">
    const { useState, useEffect } = React;
    
    function App() {
      const [isEnabled, setIsEnabled] = useState(false);
      const [templates, setTemplates] = useState([]);
      const [newTemplate, setNewTemplate] = useState({ name: '', subject: '', body: '', keywords: '' });
      const [showAddForm, setShowAddForm] = useState(false);

      useEffect(() => {
        // Load settings from Chrome storage
        chrome.storage.sync.get(['autoResponderEnabled', 'emailTemplates'], (result) => {
          setIsEnabled(result.autoResponderEnabled || false);
          setTemplates(result.emailTemplates || []);
        });
      }, []);

      const toggleExtension = () => {
        const newState = !isEnabled;
        setIsEnabled(newState);
        chrome.storage.sync.set({ autoResponderEnabled: newState });
        
        // Notify content script
        chrome.tabs.query({ active: true, currentWindow: true }, (tabs) => {
          chrome.tabs.sendMessage(tabs[0].id, { 
            action: 'toggleAutoResponder', 
            enabled: newState 
          });
        });
      };

      const addTemplate = () => {
        if (!newTemplate.name || !newTemplate.body) return;
        
        const template = {
          id: Date.now(),
          name: newTemplate.name,
          subject: newTemplate.subject || 'Auto Response',
          body: newTemplate.body,
          keywords: newTemplate.keywords.split(',').map(k => k.trim()).filter(k => k)
        };
        
        const updatedTemplates = [...templates, template];
        setTemplates(updatedTemplates);
        chrome.storage.sync.set({ emailTemplates: updatedTemplates });
        
        setNewTemplate({ name: '', subject: '', body: '', keywords: '' });
        setShowAddForm(false);
      };

      const deleteTemplate = (id) => {
        const updatedTemplates = templates.filter(t => t.id !== id);
        setTemplates(updatedTemplates);
        chrome.storage.sync.set({ emailTemplates: updatedTemplates });
      };

      return React.createElement('div', {
        className: 'app',
        style: {
          width: '400px',
          minHeight: '500px',
          padding: '20px',
          fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
          background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
          color: 'white'
        }
      }, [
        React.createElement('div', {
          key: 'header',
          className: 'header',
          style: {
            display: 'flex',
            justifyContent: 'space-between',
            alignItems: 'center',
            marginBottom: '20px',
            paddingBottom: '15px',
            borderBottom: '1px solid rgba(255, 255, 255, 0.2)'
          }
        }, [
          React.createElement('h2', {
            key: 'title',
            style: { margin: 0, fontSize: '1.4em', fontWeight: '600' }
          }, 'Email Auto Responder'),
          React.createElement('div', {
            key: 'toggle',
            style: { display: 'flex', alignItems: 'center', gap: '10px' }
          }, [
            React.createElement('label', {
              key: 'switch',
              style: {
                position: 'relative',
                display: 'inline-block',
                width: '50px',
                height: '24px'
              }
            }, [
              React.createElement('input', {
                key: 'checkbox',
                type: 'checkbox',
                checked: isEnabled,
                onChange: toggleExtension,
                style: { opacity: 0, width: 0, height: 0 }
              }),
              React.createElement('span', {
                key: 'slider',
                style: {
                  position: 'absolute',
                  cursor: 'pointer',
                  top: 0,
                  left: 0,
                  right: 0,
                  bottom: 0,
                  backgroundColor: isEnabled ? '#4CAF50' : 'rgba(255, 255, 255, 0.3)',
                  transition: '.4s',
                  borderRadius: '24px'
                }
              }, React.createElement('span', {
                style: {
                  position: 'absolute',
                  content: '""',
                  height: '18px',
                  width: '18px',
                  left: isEnabled ? '29px' : '3px',
                  bottom: '3px',
                  backgroundColor: 'white',
                  transition: '.4s',
                  borderRadius: '50%',
                  display: 'block'
                }
              }))
            ]),
            React.createElement('span', {
              key: 'status',
              style: {
                fontSize: '0.9em',
                fontWeight: '500',
                color: isEnabled ? '#4CAF50' : 'rgba(255, 255, 255, 0.7)'
              }
            }, isEnabled ? 'Enabled' : 'Disabled')
          ])
        ]),
        React.createElement('div', {
          key: 'templates',
          style: { marginBottom: '20px' }
        }, [
          React.createElement('div', {
            key: 'section-header',
            style: {
              display: 'flex',
              justifyContent: 'space-between',
              alignItems: 'center',
              marginBottom: '15px'
            }
          }, [
            React.createElement('h3', {
              key: 'templates-title',
              style: { margin: 0, fontSize: '1.2em' }
            }, 'Response Templates'),
            React.createElement('button', {
              key: 'add-btn',
              onClick: () => setShowAddForm(!showAddForm),
              style: {
                width: '30px',
                height: '30px',
                borderRadius: '50%',
                border: 'none',
                background: 'rgba(255, 255, 255, 0.2)',
                color: 'white',
                fontSize: '18px',
                cursor: 'pointer'
              }
            }, '+')
          ]),
          showAddForm && React.createElement('div', {
            key: 'add-form',
            style: {
              background: 'rgba(255, 255, 255, 0.1)',
              padding: '15px',
              borderRadius: '8px',
              marginBottom: '15px'
            }
          }, [
            React.createElement('input', {
              key: 'name-input',
              type: 'text',
              placeholder: 'Template name',
              value: newTemplate.name,
              onChange: (e) => setNewTemplate({...newTemplate, name: e.target.value}),
              style: {
                width: '100%',
                padding: '8px 12px',
                marginBottom: '10px',
                border: 'none',
                borderRadius: '4px',
                background: 'rgba(255, 255, 255, 0.9)',
                color: '#333',
                boxSizing: 'border-box'
              }
            }),
            React.createElement('input', {
              key: 'subject-input',
              type: 'text',
              placeholder: 'Email subject (optional)',
              value: newTemplate.subject,
              onChange: (e) => setNewTemplate({...newTemplate, subject: e.target.value}),
              style: {
                width: '100%',
                padding: '8px 12px',
                marginBottom: '10px',
                border: 'none',
                borderRadius: '4px',
                background: 'rgba(255, 255, 255, 0.9)',
                color: '#333',
                boxSizing: 'border-box'
              }
            }),
            React.createElement('textarea', {
              key: 'body-textarea',
              placeholder: 'Response message',
              value: newTemplate.body,
              onChange: (e) => setNewTemplate({...newTemplate, body: e.target.value}),
              rows: 3,
              style: {
                width: '100%',
                padding: '8px 12px',
                marginBottom: '10px',
                border: 'none',
                borderRadius: '4px',
                background: 'rgba(255, 255, 255, 0.9)',
                color: '#333',
                boxSizing: 'border-box',
                resize: 'vertical'
              }
            }),
            React.createElement('input', {
              key: 'keywords-input',
              type: 'text',
              placeholder: 'Keywords (comma-separated, optional)',
              value: newTemplate.keywords,
              onChange: (e) => setNewTemplate({...newTemplate, keywords: e.target.value}),
              style: {
                width: '100%',
                padding: '8px 12px',
                marginBottom: '10px',
                border: 'none',
                borderRadius: '4px',
                background: 'rgba(255, 255, 255, 0.9)',
                color: '#333',
                boxSizing: 'border-box'
              }
            }),
            React.createElement('div', {
              key: 'form-buttons',
              style: { display: 'flex', gap: '10px' }
            }, [
              React.createElement('button', {
                key: 'save',
                onClick: addTemplate,
                style: {
                  padding: '8px 16px',
                  border: 'none',
                  borderRadius: '4px',
                  cursor: 'pointer',
                  fontWeight: '500',
                  background: '#4CAF50',
                  color: 'white'
                }
              }, 'Save'),
              React.createElement('button', {
                key: 'cancel',
                onClick: () => setShowAddForm(false),
                style: {
                  padding: '8px 16px',
                  border: 'none',
                  borderRadius: '4px',
                  cursor: 'pointer',
                  fontWeight: '500',
                  background: 'rgba(255, 255, 255, 0.2)',
                  color: 'white'
                }
              }, 'Cancel')
            ])
          ]),
          React.createElement('div', {
            key: 'templates-list',
            style: {
              maxHeight: '300px',
              overflowY: 'auto'
            }
          }, templates.length === 0 ? 
            React.createElement('p', {
              style: {
                textAlign: 'center',
                color: 'rgba(255, 255, 255, 0.7)',
                fontStyle: 'italic',
                padding: '20px'
              }
            }, 'No templates yet. Add one to get started!') :
            templates.map(template => 
              React.createElement('div', {
                key: template.id,
                style: {
                  background: 'rgba(255, 255, 255, 0.1)',
                  padding: '12px',
                  borderRadius: '6px',
                  marginBottom: '10px',
                  display: 'flex',
                  justifyContent: 'space-between',
                  alignItems: 'flex-start'
                }
              }, [
                React.createElement('div', {
                  key: 'info',
                  style: { flex: 1 }
                }, [
                  React.createElement('h4', {
                    key: 'name',
                    style: { margin: '0 0 5px 0', fontSize: '1em', color: 'white' }
                  }, template.name),
                  React.createElement('p', {
                    key: 'subject',
                    style: { margin: '0 0 5px 0', fontSize: '0.85em', color: 'rgba(255, 255, 255, 0.8)' }
                  }, `Subject: ${template.subject}`),
                  React.createElement('p', {
                    key: 'body',
                    style: { 
                      margin: '0 0 8px 0', 
                      fontSize: '0.8em', 
                      color: 'rgba(255, 255, 255, 0.7)', 
                      lineHeight: 1.3 
                    }
                  }, template.body.substring(0, 100) + '...'),
                  template.keywords.length > 0 && React.createElement('div', {
                    key: 'keywords',
                    style: { fontSize: '0.75em', color: 'rgba(255, 255, 255, 0.6)' }
                  }, `Keywords: ${template.keywords.join(', ')}`)
                ]),
                React.createElement('button', {
                  key: 'delete',
                  onClick: () => deleteTemplate(template.id),
                  style: {
                    background: 'rgba(255, 82, 82, 0.8)',
                    color: 'white',
                    border: 'none',
                    width: '24px',
                    height: '24px',
                    borderRadius: '50%',
                    cursor: 'pointer',
                    fontSize: '16px',
                    marginLeft: '10px'
                  }
                }, '×')
              ])
            )
          )
        ]),
        React.createElement('div', {
          key: 'info',
          style: {
            background: 'rgba(255, 255, 255, 0.1)',
            padding: '12px',
            borderRadius: '6px'
          }
        }, React.createElement('p', {
          style: {
            margin: 0,
            fontSize: '0.85em',
            color: 'rgba(255, 255, 255, 0.8)',
            lineHeight: 1.4
          }
        }, 'When enabled, this extension will automatically respond to emails based on your templates and keywords.'))
      ]);
    }

    ReactDOM.render(React.createElement(App), document.getElementById('root'));
  </script>
</body>
</html>